<div class="grid grid-cols-3 gap-5 p-4">
    <!-- Table to show existing entries -->
    <div>
        <button mat-raised-button class="rounded-sm my-2" color="primary" (click)="addProvider(); showForm = true" type="button">Add Provider</button>
        <mat-table [dataSource]="modelsList" class="mat-elevation-z8  maxHeight">
            <ng-container matColumnDef="provider">
                <mat-header-cell *matHeaderCellDef>Provider</mat-header-cell>
                <mat-cell *matCellDef="let element">{{ element.provider }}</mat-cell>
            </ng-container>

            <ng-container matColumnDef="edit">
                <mat-header-cell *matHeaderCellDef>Actions</mat-header-cell>
                <mat-cell *matCellDef="let element">
                    <div class="flex gap-4">
                        <button class="text-[#FF7F27]" (click)="edit(element)"><mat-icon svgIcon="mat:edit"></mat-icon></button>
                        <button class="text-red-700" (click)="deleteProvider(element)"><mat-icon svgIcon="mat:delete"></mat-icon></button>
                    </div>

                </mat-cell>
            </ng-container>

            <mat-header-row *matHeaderRowDef="['provider', 'edit']"></mat-header-row>
            <mat-row *matRowDef="let row; columns: ['provider', 'edit']"></mat-row>
        </mat-table>
    </div>

    <form [formGroup]="form" (ngSubmit)="submit()" class=" col-span-2" *ngIf="showForm">
        <div class="">
            <button class="rounded-sm my-2" mat-raised-button color="primary" type="submit">Save</button>
        </div>
        <div class="maxHeight">
            <mat-form-field class="w-100">
                <mat-label>Provider</mat-label>
                <input matInput formControlName="provider" />
            </mat-form-field>

            <mat-form-field class="w-100">
                <mat-label>API Key</mat-label>
                <input matInput formControlName="apiKey" />
            </mat-form-field>

            <div formArrayName="models">
                <div *ngFor="let m of models.controls; let i = index" [formGroupName]="i" class="mb-4 border p-3 rounded shadow flex justify-between gap-4">
                    <div class="grid grid-cols-9 gap-4 w-[96%]">
                        <mat-form-field class="w-100 col-span-3">
                            <mat-label>Model Name</mat-label>
                            <input matInput formControlName="model" />
                        </mat-form-field>

                        <mat-form-field class="w-100 col-span-2">
                            <mat-label>Prompt Rate</mat-label>
                            <input matInput type="number" formControlName="promptRate" />
                        </mat-form-field>

                        <mat-form-field class="w-100 col-span-2">
                            <mat-label>Completion Rate</mat-label>
                            <input matInput type="number" formControlName="completionRate" />
                        </mat-form-field>

                        <mat-form-field class="w-100 col-span-2">
                            <mat-label>Cache Rate</mat-label>
                            <input matInput type="number" formControlName="cacheRate" />
                        </mat-form-field>
                    </div>
                    <button class="text-red-700" (click)="removeModel(i)"><mat-icon svgIcon="mat:delete"> </mat-icon></button>
                </div>
            </div>

            <button mat-raised-button color="primary" (click)="addModel()" type="button">Add Model</button>
        </div>

    </form>

</div>
